import{b as je,c as ze,d as Ve,e as $e,f as L,g as Le,h as We,i as Be}from"./chunk-TBW54ZMP.js";import{a as N,b as $}from"./chunk-7GPANA6P.js";import{$a as ae,A as J,B as d,Ba as w,Ca as ke,D as m,Da as ee,E as H,F as o,Fa as te,G as a,Ga as Fe,H as _,I as h,Ia as k,J as b,K as T,Ka as F,L as p,La as Ue,M as u,N as De,P as r,Q as S,Qa as ie,R as D,S as y,T as we,U as P,V as A,Va as Ne,W as I,Wa as Re,Xa as He,Y as Ee,Z as Pe,Za as ne,Zb as U,_a as oe,ab as re,ba as Ae,bb as se,ca as K,cb as le,da as O,db as ce,ea as Ie,eb as me,fa as Q,fb as de,gb as pe,h as G,ka as Oe,kb as M,m as g,n as C,na as ve,oa as X,qa as Y,ua as Z,v as V,w as s,y as f,z as v}from"./chunk-EMMS4W2A.js";import"./chunk-FK6H3RFT.js";import{g as x}from"./chunk-RA2WU32H.js";function Xe(i,t){i&1&&(o(0,"th",17),r(1,"Foto"),a())}function Ye(i,t){if(i&1&&(o(0,"td",18),_(1,"img",19),a()),i&2){let e=t.$implicit;s(),m("src",e.imagenUrl,V)}}function Ze(i,t){i&1&&(o(0,"th",17),r(1,"Nombre"),a())}function et(i,t){if(i&1&&(o(0,"td",18),r(1),a()),i&2){let e=t.$implicit;s(),y("",e.nombre," ",e.apellido,"")}}function tt(i,t){i&1&&(o(0,"th",17),r(1,"DNI"),a())}function it(i,t){if(i&1&&(o(0,"td",18),r(1),a()),i&2){let e=t.$implicit;s(),S(e.dni)}}function nt(i,t){i&1&&(o(0,"th",17),r(1,"Edad"),a())}function ot(i,t){if(i&1&&(o(0,"td",18),r(1),a()),i&2){let e=t.$implicit;s(),S(e.edad)}}function at(i,t){i&1&&(o(0,"th",17),r(1,"Correo"),a())}function rt(i,t){if(i&1&&(o(0,"td",18),r(1),a()),i&2){let e=t.$implicit;s(),S(e.email)}}function st(i,t){i&1&&(o(0,"th",17),r(1,"Rol"),a())}function lt(i,t){if(i&1&&(o(0,"td",18),r(1),a()),i&2){let e=t.$implicit;s(),S(e.rol)}}function ct(i,t){i&1&&(o(0,"th",17),r(1,"Estado"),a())}function mt(i,t){if(i&1&&(o(0,"span"),r(1),a()),i&2){let e=u().$implicit;s(),S(e.aprobado?"Habilitado":"Deshabilitado")}}function dt(i,t){if(i&1&&(o(0,"td",18),d(1,mt,2,1,"span",21),a()),i&2){let e=t.$implicit;s(),m("ngIf",e.rol==="especialista")}}function pt(i,t){i&1&&(h(0,20),d(1,ct,2,0,"th",6)(2,dt,2,1,"td",7),b())}function ut(i,t){i&1&&(o(0,"th",17),r(1,"Acciones"),a())}function ft(i,t){if(i&1){let e=T();o(0,"button",24),p("click",function(){g(e);let l=u().$implicit,c=u(2);return C(c.toggleEstado(l))}),r(1),a()}if(i&2){let e=u().$implicit;s(),D(" ",e.aprobado?"Deshabilitar":"Habilitar"," ")}}function _t(i,t){if(i&1&&(o(0,"td",18),d(1,ft,2,1,"button",23),a()),i&2){let e=t.$implicit;s(),m("ngIf",e.rol==="especialista")}}function gt(i,t){i&1&&(h(0,22),d(1,ut,2,0,"th",6)(2,_t,2,1,"td",7),b())}function Ct(i,t){i&1&&_(0,"tr",25)}function ht(i,t){i&1&&_(0,"tr",26)}var ue=class i{constructor(t){this.usuarioService=t}usuarios=[];roles=["paciente","especialista"];rolSeleccionado="especialista";usuariosFiltrados=[];columnas=["foto","nombre","dni","edad","email","rol","estado","acciones"];suscripcion;ngOnInit(){this.cargarUsuarios()}cargarUsuarios(){this.suscripcion=this.usuarioService.getUsuarios().subscribe(t=>{this.usuarios=t,console.log("subcribe"),console.log(this.usuarios),console.log("..................."),this.filtrarUsuarios("especialista")})}ngOnDestroy(){console.log("se salio"),this.suscripcion&&this.suscripcion.unsubscribe()}filtrarUsuarios(t){switch(this.rolSeleccionado=t,t){case"paciente":this.columnas=["foto","nombre","dni","edad","email","rol"],this.usuariosFiltrados=this.usuarios.filter(e=>e.rol==="paciente");break;case"especialista":this.columnas=["foto","nombre","dni","edad","email","rol","estado","acciones"],this.usuariosFiltrados=this.usuarios.filter(e=>e.rol==="especialista");break;default:this.columnas=["foto","nombre","dni","edad","email","rol","estado","acciones"],this.usuariosFiltrados=this.usuarios;break}}listar(){return x(this,null,function*(){this.usuarios=yield this.usuarioService.listarUsuariosPorRol(this.rolSeleccionado)})}toggleEstado(t){return x(this,null,function*(){let e=!t.aprobado;yield this.usuarioService.actualizarEstadoEspecialista(t.uid,e),t.aprobado=e})}static \u0275fac=function(e){return new(e||i)(f(N))};static \u0275cmp=v({type:i,selectors:[["app-tabla-usuarios"]],decls:32,vars:9,consts:[[1,"card-turnos-especialista"],[1,"filtros"],["mat-button","","color","warn",3,"click"],[1,"tabla-scroll"],["mat-table","",1,"mat-elevation-z2","tabla-turnos",3,"dataSource"],["matColumnDef","foto"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","dni"],["matColumnDef","edad"],["matColumnDef","email"],["matColumnDef","rol"],["matColumnDef","estado",4,"ngIf"],["matColumnDef","acciones",4,"ngIf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["alt","foto","width","40","height","40",2,"border-radius","50%",3,"src"],["matColumnDef","estado"],[4,"ngIf"],["matColumnDef","acciones"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(o(0,"mat-card",0)(1,"h2"),r(2,"Usuarios del Sistema"),a(),o(3,"div",1)(4,"button",2),p("click",function(){return n.filtrarUsuarios("paciente")}),r(5," Pacientes "),a(),o(6,"button",2),p("click",function(){return n.filtrarUsuarios("especialista")}),r(7," Especialistas "),a()(),o(8,"div",3)(9,"table",4),h(10,5),d(11,Xe,2,0,"th",6)(12,Ye,2,1,"td",7),b(),h(13,8),d(14,Ze,2,0,"th",6)(15,et,2,2,"td",7),b(),h(16,9),d(17,tt,2,0,"th",6)(18,it,2,1,"td",7),b(),h(19,10),d(20,nt,2,0,"th",6)(21,ot,2,1,"td",7),b(),h(22,11),d(23,at,2,0,"th",6)(24,rt,2,1,"td",7),b(),h(25,12),d(26,st,2,0,"th",6)(27,lt,2,1,"td",7),b(),d(28,pt,3,0,"ng-container",13)(29,gt,3,0,"ng-container",14)(30,Ct,1,0,"tr",15)(31,ht,1,0,"tr",16),a()()()),e&2&&(s(4),H("activo",n.rolSeleccionado==="paciente"),s(2),H("activo",n.rolSeleccionado==="especialista"),s(3),m("dataSource",n.usuariosFiltrados),s(19),m("ngIf",n.rolSeleccionado==="especialista"||n.rolSeleccionado==="todos"),s(),m("ngIf",n.rolSeleccionado==="especialista"||n.rolSeleccionado==="todos"),s(),m("matHeaderRowDef",n.columnas),s(),m("matRowDefColumns",n.columnas))},dependencies:[M,k,F,ne,ae,ce,re,oe,me,se,le,de,pe,Q,O,w,ke],styles:[".card-turnos-especialista[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto;padding:20px}.filtros[_ngcontent-%COMP%]{display:flex;gap:15px;margin-bottom:15px}.filtros[_ngcontent-%COMP%]   button.activo[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid currentColor}.tabla-scroll[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;border-radius:8px}.tabla-turnos[_ngcontent-%COMP%]{width:100%;min-width:600px}.tabla-turnos[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabla-turnos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px}.tabla-turnos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;object-fit:cover}"]})};var W=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=v({type:i,selectors:[["app-usuarios"]],decls:1,vars:0,template:function(e,n){e&1&&_(0,"app-tabla-usuarios")},dependencies:[ue],encapsulation:2})};var B=class i{constructor(t){this.router=t}tipo=null;abrirModal(t){let e="auth/registro/"+t;this.router.navigateByUrl(e)}static \u0275fac=function(e){return new(e||i)(f(Oe))};static \u0275cmp=v({type:i,selectors:[["app-registro-admin"]],decls:12,vars:0,consts:[[1,"titulo-registro"],[1,"selector"],[1,"boton-selector","paciente",3,"click"],[1,"texto-superpuesto"],[1,"boton-selector","especialista",3,"click"],[1,"boton-selector","admin",3,"click"]],template:function(e,n){e&1&&(o(0,"h2",0),r(1,"Registrar a usuarios como..."),a(),o(2,"div",1)(3,"button",2),p("click",function(){return n.abrirModal("paciente")}),o(4,"span",3),r(5,"Paciente"),a()(),o(6,"button",4),p("click",function(){return n.abrirModal("especialista")}),o(7,"span",3),r(8,"Especialista"),a()(),o(9,"button",5),p("click",function(){return n.abrirModal("admin")}),o(10,"span",3),r(11,"Especialista"),a()()())},dependencies:[M],styles:['.titulo-registro[_ngcontent-%COMP%]{text-align:center;font-size:2rem;margin-bottom:1rem;color:#fff}.selector[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2rem;margin-bottom:2rem;flex-wrap:wrap}.boton-selector[_ngcontent-%COMP%]{width:220px;height:220px;border:none;border-radius:12px;background-size:cover;background-position:center;position:relative;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease;box-shadow:0 4px 12px #0006}.boton-selector[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 20px #00000080}.boton-selector.paciente[_ngcontent-%COMP%]{background-image:url("./media/paciente-7NQDVGKI.jpeg")}.boton-selector.especialista[_ngcontent-%COMP%]{background-image:url("./media/especialista-5U3THJMR.jpeg")}.boton-selector.admin[_ngcontent-%COMP%]{background-image:url("./media/admin-P5LOTOXN.jpeg")}.texto-superpuesto[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:0;right:0;text-align:center;font-size:1.5rem;font-weight:700;color:#fff;text-shadow:0 0 5px rgba(0,0,0,.7);pointer-events:none}']})};function xt(i,t){i&1&&(o(0,"th",20),r(1,"\u{1F4C5} Fecha"),a())}function Tt(i,t){if(i&1&&(o(0,"td",21),r(1),a()),i&2){let e=t.$implicit;s(),S(e.fechaTurno)}}function Mt(i,t){i&1&&(o(0,"th",20),r(1,"\u{1F553} Hora"),a())}function yt(i,t){if(i&1&&(o(0,"td",21),r(1),a()),i&2){let e=t.$implicit;s(),S(e.hora)}}function Dt(i,t){i&1&&(o(0,"th",20),r(1,"\u{1F464} Paciente"),a())}function wt(i,t){if(i&1&&(o(0,"td",21),r(1),a()),i&2){let e=t.$implicit;s(),y("",e.pacienteNombre," ",e.pacienteApellido,"")}}function Et(i,t){i&1&&(o(0,"th",20),r(1,"\u{1FA7A} Especialidad"),a())}function Pt(i,t){if(i&1&&(o(0,"td",21),r(1),a()),i&2){let e=t.$implicit;s(),S(e.especialidad)}}function At(i,t){i&1&&(o(0,"th",20),r(1,"\u{1FA7A} Especialista"),a())}function It(i,t){if(i&1&&(o(0,"td",21),r(1),a()),i&2){let e=t.$implicit;s(),y("",e.especialistaNombre," ",e.especialistaApellido,"")}}function Ot(i,t){i&1&&(o(0,"th",20),r(1,"\u{1F4CC} Estado"),a())}function kt(i,t){if(i&1&&(o(0,"td",21)(1,"span",22),r(2),Ee(3,"titlecase"),a()()),i&2){let e=t.$implicit;s(),m("ngClass",e.estado),s(),S(Pe(3,2,e.estado))}}function Ft(i,t){i&1&&(o(0,"th",20),r(1,"\u2699 Acciones"),a())}function Ut(i,t){if(i&1){let e=T();o(0,"button",4),p("click",function(){g(e);let l=u().$implicit,c=u();return C(c.cancelarTurno(l))}),r(1,"Cancelar"),a()}}function Nt(i,t){if(i&1){let e=T();o(0,"button",2),p("click",function(){g(e);let l=u().$implicit,c=u();return C(c.verCancelacion(l))}),r(1,"Motivo"),a()}}function Rt(i,t){if(i&1){let e=T();o(0,"button",2),p("click",function(){g(e);let l=u().$implicit,c=u();return C(c.verDevolucion(l))}),r(1,"Devolucion del medico"),a()}}function Ht(i,t){if(i&1){let e=T();o(0,"button",2),p("click",function(){g(e);let l=u().$implicit,c=u();return C(c.verCalificacion(l))}),r(1,"Calificacion del paciente"),a()}}function jt(i,t){if(i&1&&(o(0,"td",21),d(1,Ut,2,0,"button",23)(2,Nt,2,0,"button",24)(3,Rt,2,0,"button",24)(4,Ht,2,0,"button",24),a()),i&2){let e=t.$implicit,n=u();s(),m("ngIf",n.puedeCancelar(e)),s(),m("ngIf",e.comentarioCancelacion),s(),m("ngIf",e.resenaEspecialista),s(),m("ngIf",e.calificacionPaciente)}}function zt(i,t){i&1&&_(0,"tr",25)}function Vt(i,t){i&1&&_(0,"tr",26)}var fe=class i{constructor(t,e,n,l){this.dialog=t;this.toast=e;this.turnosService=n;this.authService=l}turnos=[];turnosFiltrados=[];columnas=["fechaTurno","hora","paciente","especialidad","especialista","estado","acciones"];busqueda="";uidEspecialista="";estadoSeleccionado="activos";usuario;ngOnInit(){this.authService.usuario$.subscribe(t=>{t&&(this.usuario=t,this.turnosService.obtenerTodoTurnos().subscribe(e=>{this.turnos=e,this.turnosFiltrados=[...this.turnos],console.log(this.turnos),this.filtrar("activos")}))})}filtrar(t){this.estadoSeleccionado=t,t==="activos"?this.turnosFiltrados=this.turnos.filter(e=>e.estado==="pendiente"||e.estado==="aceptado"):t==="realizado"?this.turnosFiltrados=this.turnos.filter(e=>e.estado==="realizado"):t==="cancelados"&&(this.turnosFiltrados=this.turnos.filter(e=>e.estado==="cancelado"||e.estado==="rechazado"))}aplicarFiltro(){let t=this.busqueda.toLowerCase();this.turnosFiltrados=this.turnos.filter(e=>e.pacienteNombre.toLowerCase().includes(t)||e.pacienteApellido.toLowerCase().includes(t)||e.especialidad.toLowerCase().includes(t))}puedeAceptar(t){return!["realizado","rechazado","aceptado","cancelado"].includes(t.estado)}puedeRechazar(t){return!["aceptado","realizado","rechazado","cancelado"].includes(t.estado)}puedeCancelar(t){return!["aceptado","realizado","rechazado","cancelado"].includes(t.estado)}puedeFinalizar(t){return t.estado==="aceptado"}aceptarTurno(t){this.turnosService.actualizarEstado(t,"aceptado")}rechazarTurno(t){let e=prompt("Motivo del rechazo:");e&&this.turnosService.actualizarEstado(t,"rechazado",e)}cancelarTurno(t){this.dialog.open($e,{width:"400px",data:{titulo:"Cancelar Turno",nombre:`${this.usuario.nombre} ${this.usuario.apellido} (${this.usuario.rol})`}}).afterClosed().subscribe(n=>{if(n){let l=this.usuario.nombre+"@"+this.usuario.apellido+"@"+this.usuario.rol+"@"+n;this.turnosService.actualizarEstado(t,"cancelado",l),console.log("Motivo ingresado:",n)}})}finalizarTurno(t){let e=prompt("Ingrese rese\xF1a o diagn\xF3stico:");e&&this.turnosService.actualizarEstado(t,"realizado",e)}verCancelacion(t){this.dialog.open(Ve,{width:"400px",data:{comentario:t.comentarioCancelacion}})}verCalificacion(t){t.calificacionPaciente||this.toast.mostrarMensaje("Este turno no tiene calificaci\xF3n registrada","Calificaci\xF3n","info"),this.dialog.open(ze,{width:"500px",data:{modo:"ver",id:t.calificacionPaciente}})}verDevolucion(t){if(!t.resenaEspecialista){this.toast.mostrarMensaje("Este turno no tiene rese\xF1a registrada","Rese\xF1a","info");return}let e=this.dialog.open(je,{width:"500px",data:{modo:"ver",id:t.resenaEspecialista},disableClose:!0})}formatearFecha(t){let e=t.toDate(),n=e.getDate().toString().padStart(2,"0"),l=(e.getMonth()+1).toString().padStart(2,"0"),c=e.getFullYear();return`${n}/${l}/${c}`}static \u0275fac=function(e){return new(e||i)(f(ie),f($),f(L),f(U))};static \u0275cmp=v({type:i,selectors:[["app-turnos-admin"]],decls:39,vars:10,consts:[[1,"card-turnos-especialista"],[1,"filtros"],["mat-button","","color","primary",3,"click"],["mat-button","","color","accent",3,"click"],["mat-button","","color","warn",3,"click"],["appearance","outline",1,"buscador"],["matInput","",3,"ngModelChange","input","ngModel"],[1,"tabla-scroll"],["mat-table","",1,"mat-elevation-z2","tabla-turnos",3,"dataSource"],["matColumnDef","fechaTurno"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","hora"],["matColumnDef","paciente"],["matColumnDef","especialidad"],["matColumnDef","especialista"],["matColumnDef","estado"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"estado",3,"ngClass"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(e,n){e&1&&(o(0,"mat-card",0)(1,"h2"),r(2,"Turnos general"),a(),o(3,"div",1)(4,"button",2),p("click",function(){return n.filtrar("activos")}),r(5," \u{1F552} Pendientes / Aceptados "),a(),o(6,"button",3),p("click",function(){return n.filtrar("realizado")}),r(7," \u2714 Realizados "),a(),o(8,"button",4),p("click",function(){return n.filtrar("cancelados")}),r(9," \u274C Cancelados / Rechazados "),a(),o(10,"mat-form-field",5)(11,"mat-label"),r(12,"Buscar paciente o especialidad"),a(),o(13,"input",6),I("ngModelChange",function(c){return A(n.busqueda,c)||(n.busqueda=c),c}),p("input",function(){return n.aplicarFiltro()}),a()()(),o(14,"div",7)(15,"table",8),h(16,9),d(17,xt,2,0,"th",10)(18,Tt,2,1,"td",11),b(),h(19,12),d(20,Mt,2,0,"th",10)(21,yt,2,1,"td",11),b(),h(22,13),d(23,Dt,2,0,"th",10)(24,wt,2,2,"td",11),b(),h(25,14),d(26,Et,2,0,"th",10)(27,Pt,2,1,"td",11),b(),h(28,15),d(29,At,2,0,"th",10)(30,It,2,2,"td",11),b(),h(31,16),d(32,Ot,2,0,"th",10)(33,kt,4,4,"td",11),b(),h(34,17),d(35,Ft,2,0,"th",10)(36,jt,5,4,"td",11),b(),d(37,zt,1,0,"tr",18)(38,Vt,1,0,"tr",19),a()()()),e&2&&(s(4),H("activo",n.estadoSeleccionado==="activos"),s(2),H("activo",n.estadoSeleccionado==="realizado"),s(2),H("activo",n.estadoSeleccionado==="cancelados"),s(5),P("ngModel",n.busqueda),s(2),m("dataSource",n.turnosFiltrados),s(22),m("matHeaderRowDef",n.columnas),s(),m("matRowDefColumns",n.columnas))},dependencies:[M,Fe,te,ee,k,F,ne,ae,ce,re,oe,me,se,le,de,pe,Ae,w,X,Y,Z,O,Ie],styles:[".card-turnos-especialista[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto;padding:20px}.filtros[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center;margin-bottom:15px}.filtros[_ngcontent-%COMP%]   .buscador[_ngcontent-%COMP%]{flex:1;min-width:250px}.filtros[_ngcontent-%COMP%]   button.activo[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid currentColor}.tabla-scroll[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;border-radius:8px}.tabla-turnos[_ngcontent-%COMP%]{width:100%;min-width:600px}.tabla-turnos[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tabla-turnos[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px}.tabla-turnos[_ngcontent-%COMP%]   .estado[_ngcontent-%COMP%]{padding:4px 8px;border-radius:5px}.tabla-turnos[_ngcontent-%COMP%]   .estado.pendiente[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.tabla-turnos[_ngcontent-%COMP%]   .estado.aceptado[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.tabla-turnos[_ngcontent-%COMP%]   .estado.realizado[_ngcontent-%COMP%]{background:#c3e6cb;color:#155724}.tabla-turnos[_ngcontent-%COMP%]   .estado.cancelado_paciente[_ngcontent-%COMP%], .tabla-turnos[_ngcontent-%COMP%]   .estado.cancelado_especialista[_ngcontent-%COMP%], .tabla-turnos[_ngcontent-%COMP%]   .estado.rechazado[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}"]})};function $t(i,t){if(i&1&&(o(0,"mat-option",7),r(1),a()),i&2){let e=t.$implicit;m("value",e),s(),we(" ",e.apellido," ",e.nombre," - ",e.dni," ")}}function Lt(i,t){if(i&1&&(o(0,"mat-option",7),r(1),a()),i&2){let e=t.$implicit;m("value",e),s(),S(e)}}function Wt(i,t){if(i&1&&(o(0,"mat-option",7),r(1),a()),i&2){let e=t.$implicit;m("value",e),s(),y(" Dr./Dra. ",e.nombre," ",e.apellido," ")}}function Bt(i,t){if(i&1){let e=T();o(0,"mat-form-field",2)(1,"mat-label"),r(2,"\u{1F464} Profesional"),a(),o(3,"mat-select",8),I("ngModelChange",function(l){g(e);let c=u(2);return A(c.especialistaSeleccionado,l)||(c.especialistaSeleccionado=l),C(l)}),p("selectionChange",function(){g(e);let l=u(2);return C(l.cargarFechasDisponibles())}),d(4,Wt,2,3,"mat-option",5),a()()}if(i&2){let e=u(2);s(3),P("ngModel",e.especialistaSeleccionado),s(),m("ngForOf",e.especialistasFiltrados)}}function qt(i,t){if(i&1&&(o(0,"mat-option",7),r(1),a()),i&2){let e=t.$implicit;m("value",e),s(),D(" ",e," ")}}function Gt(i,t){if(i&1){let e=T();o(0,"mat-form-field",2)(1,"mat-label"),r(2,"\u{1F4C5} Fecha Disponible"),a(),o(3,"mat-select",8),I("ngModelChange",function(l){g(e);let c=u(2);return A(c.fechaSeleccionada,l)||(c.fechaSeleccionada=l),C(l)}),p("selectionChange",function(){g(e);let l=u(2);return C(l.seleccionarFecha(l.fechaSeleccionada))}),d(4,qt,2,2,"mat-option",5),a()()}if(i&2){let e=u(2);s(3),P("ngModel",e.fechaSeleccionada),s(),m("ngForOf",e.fechasDisponibles)}}function Jt(i,t){i&1&&(o(0,"span"),r(1," (Ocupado)"),a())}function Kt(i,t){if(i&1&&(o(0,"mat-option",12),r(1),d(2,Jt,2,0,"span",6),a()),i&2){let e=t.$implicit;m("value",e.hora)("disabled",e.estado==="ocupado"),s(),D(" ",e.hora," "),s(),m("ngIf",e.estado==="ocupado")}}function Qt(i,t){if(i&1&&(o(0,"mat-form-field",2)(1,"mat-label"),r(2,"\u{1F552} Horario Disponible"),a(),o(3,"mat-select"),d(4,Kt,3,4,"mat-option",11),a()()),i&2){let e=u(2);s(4),m("ngForOf",e.horariosDisponibles)}}function Xt(i,t){if(i&1){let e=T();o(0,"div",13)(1,"button",14),p("click",function(){g(e);let l=u(2);return C(l.reservarTurno(l.fechaSeleccionada,l.getPrimerHorarioDisponible()))}),r(2," \u{1F4C5} Confirmar Turno "),a()()}}function Yt(i,t){if(i&1){let e=T();o(0,"div")(1,"mat-form-field",2)(2,"mat-label"),r(3,"\u{1FA7A} Especialidad M\xE9dica"),a(),o(4,"mat-select",8),I("ngModelChange",function(l){g(e);let c=u();return A(c.especialidadSeleccionada,l)||(c.especialidadSeleccionada=l),C(l)}),p("selectionChange",function(){g(e);let l=u();return C(l.cargarEspecialistas())}),d(5,Lt,2,2,"mat-option",5),a()(),d(6,Bt,5,2,"mat-form-field",9)(7,Gt,5,2,"mat-form-field",9)(8,Qt,5,1,"mat-form-field",9)(9,Xt,3,0,"div",10),a()}if(i&2){let e=u();s(4),P("ngModel",e.especialidadSeleccionada),s(),m("ngForOf",e.especialidades),s(),m("ngIf",e.especialistasFiltrados.length>0),s(),m("ngIf",e.fechasDisponibles.length>0&&e.especialistasFiltrados.length>0),s(),m("ngIf",e.horariosDisponibles.length>0&&e.especialistasFiltrados.length>0),s(),m("ngIf",e.puedeConfirmarTurno)}}var _e=class i{constructor(t,e,n,l){this.turnosService=t;this.toastService=e;this.usuariosService=n;this.auth=l}especialidades=["Dermatolog\xEDa","Cardiolog\xEDa","Pediatr\xEDa"];especialidadSeleccionada="";especialistasFiltrados=[];especialistaSeleccionado;fechasDisponibles=[];fechaSeleccionada="";horariosDisponibles=[];usuarioLogueado=null;pacientes;pacienteSeleccionado;filtroPaciente="";pacienteFiltrados=[];ngOnInit(){this.auth.usuario$.subscribe(t=>{t?this.usuarioLogueado=t:this.usuarioLogueado={rol:"no-registrado"}}),this.cargarPaciente(),this.cargarListaEspecialidades()}cargarListaEspecialidades(){return x(this,null,function*(){this.especialidades=yield this.usuariosService.obtenerEspecialidadesUnicas()})}pacientesFiltrados(){if(!this.filtroPaciente)return this.pacientes;let t=this.filtroPaciente.toLowerCase();return this.pacientes.filter(e=>e.apellido.toLowerCase().includes(t)||e.nombre.toLowerCase().includes(t)||e.dni.toString().includes(t))}cargarPaciente(){this.usuariosService.getUsuarios().subscribe(t=>{this.pacientes=t.filter(e=>e.rol==="paciente"&&e.correoVerificado===!0)})}cargarEspecialistas(){this.especialistaSeleccionado=null,this.fechaSeleccionada="",this.fechasDisponibles=[],this.horariosDisponibles=[],this.usuariosService.getUsuarios().subscribe(t=>{this.especialistasFiltrados=t.filter(e=>e.rol==="especialista"&&e.aprobado&&e.especialidades.includes(this.especialidadSeleccionada))})}generarHorarios(t){let e=t.disponibilidad?.horarios||[],n=[];for(let l of e){let[c,z]=l.replace(".",":").split(" a "),[R,q]=c.split(":").map(Number),[ye,Ke]=z.split(":").map(Number);for(;R<ye||R===ye&&q<Ke;)n.push(`${R.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`),q+=30,q===60&&(q=0,R++)}return n}cargarFechasDisponibles(){this.horariosDisponibles=[],this.fechaSeleccionada="",this.fechasDisponibles=[],console.log("ESPECIALISTA SELECCIONADO"),console.log(this.especialistaSeleccionado),console.log(this.especialistaSeleccionado.disponibilidad);let t=this.especialistaSeleccionado.disponibilidad;if(!t||!Array.isArray(t.dias)||t.dias.length===0||!Array.isArray(t.horarios)||t.horarios.length===0){this.toastService.mostrarMensaje("El especialista no tiene horarios/d\xEDas disponibles","Solicitud turnos","info");return}let e=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],n=new Date,l=1;switch(t.dias.length){case 1:l=3;break;case 2:l=5;break;case 3:l=7;break;case 4:l=9;break;case 5:l=11;break;case 6:l=13;break}console.log("dias leght: "+t.dias.length),console.log("for contador: "+l),console.log("for contador multipli: "+(2+(t.dias.length+t.dias.length-1)));for(let c=0;this.fechasDisponibles.length<l;c++){let z=new Date;z.setDate(n.getDate()+c);let R=e[z.getDay()];t.dias.includes(R)&&this.fechasDisponibles.push(z.toISOString().split("T")[0])}console.log("FECHAS CARGADAS:"),console.log(this.fechasDisponibles)}seleccionarFecha(t){return x(this,null,function*(){this.fechaSeleccionada=t;let e=this.generarHorarios(this.especialistaSeleccionado),n=[];(yield this.turnosService.getTurnosByEspecialistaFecha(this.especialistaSeleccionado.uid,t)).forEach(c=>{["pendiente","aceptado"].includes(c.estado)&&n.push(c.hora)}),this.horariosDisponibles=e.map(c=>({hora:c,estado:n.includes(c)?"ocupado":"disponible"}))})}get puedeConfirmarTurno(){return!!this.fechaSeleccionada&&this.horariosDisponibles.some(t=>t.estado==="disponible")}getPrimerHorarioDisponible(){let t=this.horariosDisponibles.find(e=>e.estado==="disponible");return t?t.hora:""}reservarTurno(t,e){return x(this,null,function*(){if(!this.especialidadSeleccionada||!this.especialistaSeleccionado||!t||!e){this.toastService.mostrarMensaje("Faltan datos obligatorios para reservar el turno.","Reserva de turno","error");return}if(!(yield this.turnosService.verificarDisponibilidad(this.especialistaSeleccionado.uid,t,e))){this.toastService.mostrarMensaje("Horario ocupado","Ese turno ya fue solicitado.","info");return}let l={especialidad:this.especialidadSeleccionada,fechaTurno:t,fechaSolicictado:new Date,hora:e,estado:"pendiente",especialistaUid:this.especialistaSeleccionado.uid,especialistaNombre:this.especialistaSeleccionado.nombre,especialistaApellido:this.especialistaSeleccionado.apellido,especialistaDni:this.especialistaSeleccionado.dni,pacienteUid:this.pacienteSeleccionado.uid,pacienteNombre:this.pacienteSeleccionado.nombre,pacienteApellido:this.pacienteSeleccionado.apellido,pacienteDni:this.pacienteSeleccionado.dni,obraSocial:this.pacienteSeleccionado.obraSocial};yield this.turnosService.guardarTurno(l),this.toastService.mostrarMensaje("\xC9xito","Turno reservado correctamente.","success")})}static \u0275fac=function(e){return new(e||i)(f(L),f($),f(N),f(U))};static \u0275cmp=v({type:i,selectors:[["app-solicitar-turno-admin"]],decls:11,vars:4,consts:[[1,"form-card"],[1,"titulo"],["appearance","fill",1,"form-control"],[3,"ngModelChange","ngModel"],["placeholder","Buscar por nombre o DNI",2,"width","100%","border","none","outline","none","padding","5px",3,"ngModelChange","click","keyup","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[3,"ngModelChange","selectionChange","ngModel"],["appearance","fill","class","form-control",4,"ngIf"],["class","boton-container",4,"ngIf"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],[1,"boton-container"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,n){e&1&&(o(0,"mat-card",0)(1,"h2",1),r(2,"Solicitar Nuevo Turno"),a(),o(3,"mat-form-field",2)(4,"mat-label"),r(5,"\u{1FA7A} Paciente"),a(),o(6,"mat-select",3),I("ngModelChange",function(c){return A(n.pacienteSeleccionado,c)||(n.pacienteSeleccionado=c),c}),o(7,"mat-option")(8,"input",4),I("ngModelChange",function(c){return A(n.filtroPaciente,c)||(n.filtroPaciente=c),c}),p("click",function(c){return c.stopPropagation()})("keyup",function(c){return c.stopPropagation()}),a()(),d(9,$t,2,4,"mat-option",5),a()(),d(10,Yt,10,6,"div",6),a()),e&2&&(s(6),P("ngModel",n.pacienteSeleccionado),s(2),P("ngModel",n.filtroPaciente),s(),m("ngForOf",n.pacientesFiltrados()),s(),m("ngIf",n.pacienteSeleccionado))},dependencies:[M,te,ee,k,F,Re,Ne,K,O,w,X,Y,Z],styles:[".form-card[_ngcontent-%COMP%]{max-width:500px;margin:40px auto;padding:30px;background-color:#f5f9ff;border-radius:12px}.titulo[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px;color:#1a237e;font-weight:700}.form-control[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.boton-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}"]})};function Zt(i,t){if(i&1){let e=T();o(0,"div",2),p("click",function(){let l=g(e).$implicit,c=u();return C(c.verHistorial(l.uid,l.rol))}),o(1,"div",3),_(2,"img",4),a(),o(3,"div",5)(4,"span",6),r(5),a()(),o(6,"span",7),r(7),a(),_(8,"br"),a()}if(i&2){let e=t.$implicit;s(2),De("alt","foto de ",e.nombre,""),m("src",e.imagenUrl,V),s(3),y("",e.nombre," ",e.apellido,""),s(2),S(e.rol)}}var ge=class i{constructor(t,e,n,l,c,z,R){this.authService=t;this.turnosService=e;this.usuarioService=n;this.historialService=l;this.pdfService=c;this.dialog=z;this.toast=R}pacientes=[];especialista;uidEspecialista;ngOnInit(){return x(this,null,function*(){this.usuarioService.obtenerTodosLosUsuarios().subscribe(t=>x(this,null,function*(){this.pacientes=t}))})}verHistorial(t,e){return x(this,null,function*(){if(e!=="paciente"){this.toast.mostrarMensaje("Este usuario es un especialista y no tiene historia cl\xEDnica","Historial","info");return}let n=yield this.historialService.obtenerHistorialMedico(t);if(!n||n.length===0){this.toast.mostrarMensaje("Este paciente a\xFAn no tiene historia cl\xEDnica registrada.","Historial","info");return}this.dialog.open(Be,{data:{historial:n,uid:t},width:"600px"})})}descargarHistorial(t){return x(this,null,function*(){let e=yield this.historialService.obtenerHistorialMedico(t);this.pdfService.generarPDF(e)})}static \u0275fac=function(e){return new(e||i)(f(U),f(L),f(N),f(Le),f(We),f(ie),f($))};static \u0275cmp=v({type:i,selectors:[["app-todo-usuarios"]],decls:5,vars:1,consts:[[1,"pacientes-grid"],["class","paciente-card",3,"click",4,"ngFor","ngForOf"],[1,"paciente-card",3,"click"],[1,"imagen-container"],[3,"src","alt"],[1,"nombre-con-estado"],[1,"nombre"],[1,"rol"]],template:function(e,n){e&1&&(_(0,"br")(1,"br"),o(2,"div",0),d(3,Zt,9,6,"div",1),a(),_(4,"br")),e&2&&(s(3),m("ngForOf",n.pacientes))},dependencies:[M,w,K],styles:[".pacientes-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:30px;margin-top:20px}.paciente-card[_ngcontent-%COMP%]{text-align:center;cursor:pointer;transition:transform .2s ease;max-width:150px}.paciente-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.paciente-card[_ngcontent-%COMP%]   .imagen-container[_ngcontent-%COMP%]{width:120px;height:120px;margin:auto;border-radius:50%;overflow:hidden;border:4px solid #f0f0f0;box-shadow:0 0 10px #0000001a}.paciente-card[_ngcontent-%COMP%]   .imagen-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.paciente-card[_ngcontent-%COMP%]   .nombre-con-estado[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:8px;gap:6px}.paciente-card[_ngcontent-%COMP%]   .nombre-con-estado[_ngcontent-%COMP%]   .estado[_ngcontent-%COMP%]{width:14px;height:14px;background:linear-gradient(145deg,#00c853,#69f0ae);border-radius:50%;display:inline-block}.paciente-card[_ngcontent-%COMP%]   .nombre-con-estado[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{font-weight:500;color:#fff}.rol[_ngcontent-%COMP%]{font-size:14px;color:gray;margin-top:4px}"]})};function ei(i,t){i&1&&_(0,"app-registro-admin")}function ti(i,t){i&1&&_(0,"app-usuarios")}function ii(i,t){i&1&&_(0,"app-turnos-admin")}function ni(i,t){i&1&&_(0,"app-solicitar-turno-admin")}function oi(i,t){i&1&&_(0,"app-todo-usuarios")}var Ce=class i{tipo=null;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=v({type:i,selectors:[["app-home-admin"]],decls:21,vars:5,consts:[[1,"selector"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"formulario"],[4,"ngIf"]],template:function(e,n){e&1&&(o(0,"h1"),r(1,"Panel de adminsitrador"),a(),o(2,"div",0)(3,"button",1),p("click",function(){return n.tipo="aceptar-rechazar"}),r(4,"Aceptar o Rechazar Especialistas"),a(),o(5,"button",2),p("click",function(){return n.tipo="registrar-usuarios"}),r(6,"Registrar usuarios"),a(),o(7,"button",2),p("click",function(){return n.tipo="listado"}),r(8,"Listado de turnos"),a(),o(9,"button",2),p("click",function(){return n.tipo="turnos"}),r(10,"Gestionar turno"),a(),o(11,"button",2),p("click",function(){return n.tipo="usuarios"}),r(12,"Usuarios"),a()(),_(13,"br")(14,"br"),o(15,"div",3),d(16,ei,1,0,"app-registro-admin",4)(17,ti,1,0,"app-usuarios",4)(18,ii,1,0,"app-turnos-admin",4)(19,ni,1,0,"app-solicitar-turno-admin",4)(20,oi,1,0,"app-todo-usuarios",4),a()),e&2&&(s(16),m("ngIf",n.tipo==="registrar-usuarios"),s(),m("ngIf",n.tipo==="aceptar-rechazar"),s(),m("ngIf",n.tipo==="listado"),s(),m("ngIf",n.tipo==="turnos"),s(),m("ngIf",n.tipo==="usuarios"))},dependencies:[M,k,B,W,O,fe,_e,ge],styles:[".selector[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2rem;margin-top:1.5rem;flex-wrap:wrap}.selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:220px;height:100px;font-size:1rem;font-weight:700;border-radius:8px;text-align:center;padding:1rem;white-space:normal;line-height:1.4}h1[_ngcontent-%COMP%]{text-align:center;color:#3f51b5;margin-top:1rem}"]})};var he=class i{constructor(t,e){this.auth=t;this.usuarioService=e}usuario;ngOnInit(){return x(this,null,function*(){let t=yield this.auth.obtenerSesion();t&&(this.usuario=yield this.usuarioService.obtenerUsuario(t.uid))})}static \u0275fac=function(e){return new(e||i)(f(U),f(N))};static \u0275cmp=v({type:i,selectors:[["app-mi-perfil-admin"]],decls:34,vars:7,consts:[[1,"perfil-facebook"],[1,"portada-container"],["src","../../../../assets/imagenes/bienvenida.jpg","alt","Foto de portada",1,"foto-portada"],["alt","Foto de perfil",1,"foto-perfil-superpuesta",3,"src"],[1,"contenido-perfil"],[1,"nombre-usuario"],[1,"perfil-grid"],[1,"seccion-info"],[1,"info-item"]],template:function(e,n){e&1&&(o(0,"mat-card",0)(1,"div",1),_(2,"img",2)(3,"img",3),a(),o(4,"mat-card-content",4),_(5,"br"),o(6,"h2",5),r(7),a(),o(8,"h4",5)(9,"mat-icon"),r(10,"mail"),a(),o(11,"span"),r(12),a()(),o(13,"div",6)(14,"div",7)(15,"h3")(16,"mat-icon"),r(17,"person"),a(),r(18," Datos Personales"),a(),o(19,"div",8)(20,"mat-icon"),r(21,"badge"),a(),o(22,"span"),r(23),a()(),o(24,"div",8)(25,"mat-icon"),r(26,"calendar_today"),a(),o(27,"span"),r(28),a()(),o(29,"div",8)(30,"mat-icon"),r(31,"verified_user"),a(),o(32,"span"),r(33),a()()()()()()),e&2&&(s(3),m("src",n.usuario==null?null:n.usuario.imagenUrl,V),s(4),y("Administrador. ",n.usuario==null?null:n.usuario.nombre," ",n.usuario==null?null:n.usuario.apellido," "),s(5),D("Email: ",n.usuario==null?null:n.usuario.email,""),s(11),D("DNI: ",n.usuario==null?null:n.usuario.dni,""),s(5),D("Edad: ",n.usuario==null?null:n.usuario.edad,""),s(5),D("Rol: ",n.usuario==null?null:n.usuario.rol,""))},dependencies:[M,F,Ue,He,w],styles:[".perfil-facebook[_ngcontent-%COMP%]{max-width:850px;margin:auto;border-radius:12px;overflow:hidden}.portada-container[_ngcontent-%COMP%]{position:relative;height:200px}.foto-portada[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.foto-perfil-superpuesta[_ngcontent-%COMP%]{position:absolute;bottom:-50px;left:50%;transform:translate(-50%);border:4px solid white;border-radius:50%;width:100px;height:100px;object-fit:cover;background-color:#fff}.contenido-perfil[_ngcontent-%COMP%]{padding-top:60px;padding:1rem;text-align:left}.nombre-usuario[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.perfil-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(50px,1fr));gap:1rem}.seccion-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.05rem;display:flex;align-items:center;gap:6px;color:#1a237e}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:6px 0}mat-icon[_ngcontent-%COMP%]{color:#1a73e8}"]})};var ai=[{path:"",component:Ce},{path:"lista",component:W},{path:"registro",component:B},{path:"perfil",component:he}],be=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=J({type:i});static \u0275inj=G({imports:[ve.forChild(ai),ve]})};var Je=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=J({type:i});static \u0275inj=G({imports:[Q,be]})};export{Je as AdminModule};
